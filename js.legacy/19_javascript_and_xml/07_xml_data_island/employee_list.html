<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
	<title>Список служащих: пример применения островков XML-данных</title>
	<meta http-equiv="content-type" content="text/html; charset=windows-1251" />
	<meta name="author" content="D.I.V." />
</head>
<body>
<xml id="myIsland" src="staff.xml"></xml>
<h1 align="center">Персонал DemoCompany</h1>
<hr />
<table width="100%" datasrc="#myIsland" border="1">
    <thead>
        <tr>
            <th>Имя</th>
            <th>Должность</th>
            <th>Телефон</th>
            <th>Адрес электронной почты</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><span datafld="name"></span></td>
            <td><span datafld="title"></span></td>
            <td><span datafld="phone"></span></td>
            <td><span datafld="email"></span></td>
        </tr>
    </tbody>
</table>

<script type="text/javascript">
<!--
/* ассоциация с XML-документом из островка данных */
xmldoc = myIsland;

function deleteLastElement() {
    /* поиск корневого элемента и удаление его последнего дочернего */
    var rootElement = xmldoc.documentElement;
    if (rootElement.hasChildNodes())
        rootElement.removeChild(rootElement.lastChild);
}

function addElement() {
    var rootElement = xmldoc.documentElement;
    
    /* создание элемента employee */
    var newEmployee = xmldoc.createElement('employee');
    
    /* создание и добавление дочернего элемента и текстовых значений */
    var newName = xmldoc.createElement('name');
    var newNameText = xmldoc.createTextNode(document.myform.namefield.value);
    newName.appendChild(newNameText);
    newEmployee.appendChild(newName);
    
    var newTitle = xmldoc.createElement('title');
    var newTitleText = xmldoc.createTextNode(document.myform.titlefield.value);
    newTitle.appendChild(newTitleText);
    newEmployee.appendChild(newTitle);
    
    var newPhone = xmldoc.createElement('phone');
    var newPhoneText = xmldoc.createTextNode(document.myform.phonefield.value);
    newPhone.appendChild(newPhoneText);
    newEmployee.appendChild(newPhone);
    
    var newEmail = xmldoc.createElement('email');
    var newEmailText = xmldoc.createTextNode(document.myform.emailfield.value);
    newEmail.appendChild(newEmailText);
    newEmployee.appendChild(newEmail);
    
    /* Добавление готовой записи в документ */
    rootElement.appendChild(newEmployee);
}
//-->
</script>

<form id="myform" name="myform" action="#" method="get">
    Имя: <input type="text" name="namefield" id="namefield" size="50" /><br />
    Должность: <input type="text" name="titlefield" id="titlefield" size="30" /><br />
    Телефон: <input type="text" name="phonefield" id="phonefield" size="20" /><br />
    Адрес электронной почты: <input type="text" name="emailfield" id="emailfield" size="20" /><br />
    
    <input type="button" value="добавить запись" onclick="addElement();" />
        
    <input type="button" value="удалить последнюю запись" onclick="deleteLastElement();" />
</form>
</body>
</html>
